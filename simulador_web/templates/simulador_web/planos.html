{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Planos - Algop</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:#020617;
  color:#e5e7eb;
  margin:0;
}

header{
  padding:20px 48px;
  border-bottom:1px solid rgba(148,163,184,.18);
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header h1{margin:0;font-size:22px}
header a{
  color:#e5e7eb;
  text-decoration:none;
  border:1px solid rgba(148,163,184,.25);
  padding:10px 18px;
  border-radius:10px;
}

main{
  max-width:1100px;
  margin:80px auto;
  padding:0 24px;
  text-align:center;
}

main h2{font-size:38px;margin-bottom:12px}
main p.lead{
  color:#9ca3af;
  font-size:18px;
  margin-bottom:50px;
}

.plans{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:40px;
  align-items:stretch;
}

.plan-card{
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  background:
    radial-gradient(120% 120% at 10% 10%, rgba(59,130,246,.18), transparent),
    linear-gradient(180deg, rgba(30,41,59,.7), rgba(2,6,23,.95));
  border:1px solid rgba(148,163,184,.2);
  border-radius:22px;
  padding:32px;
}

.plan-top{flex:1}

.plan-card h3{font-size:26px;margin:0 0 10px}
.plan-card p{color:#9ca3af;margin-bottom:16px}

.plan-card ul{
  list-style:none;
  padding:0;
  margin:0 0 24px;
}

.plan-card li{margin-bottom:8px}
.plan-card li::before{content:"✔ ";color:#3b82f6;font-weight:700}

.plan-actions{margin-top:24px}

.btn-primary{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:0;
  background:linear-gradient(90deg,#3b82f6,#60a5fa);
  color:#020617;
  font-weight:800;
  cursor:pointer;
  margin-bottom:12px;
}

.btn-test{
  background:linear-gradient(90deg,#f59e0b,#fbbf24);
}

.test-area{
  margin-top:80px;
  padding:32px;
  border:1px dashed rgba(148,163,184,.3);
  border-radius:18px;
}

footer{
  margin-top:120px;
  padding:40px;
  border-top:1px solid rgba(148,163,184,.18);
  text-align:center;
  color:#9ca3af;
  font-size:14px;
}
</style>
</head>

<body>

{% csrf_token %}

<header>
  <h1>Algop</h1>
  <a href="/">Voltar</a>
</header>

<main>
<h2>Planos de acesso ao Algop</h2>
<p class="lead">
  Escolha o plano mais adequado ao seu perfil de uso.
</p>

<div class="plans">

<!-- BÁSICO -->
<div class="plan-card">
  <div class="plan-top">
    <h3>Básico</h3>
    <p>Acesso essencial à metodologia Algop.</p>
    <ul>
      <li>Acesso limitado à plataforma</li>
      <li>Screener de Long Straddle</li>
      <li>Avaliação focada em D+1</li>
    </ul>
  </div>

  <div class="plan-actions">
    <button class="btn-primary" onclick="assinarPlano('BASICO_MENSAL')">
      Básico Mensal — R$ 79 / mês
    </button>

    <button class="btn-primary" onclick="assinarPlano('BASICO_ANUAL')">
      Básico Anual — R$ 797 / ano
    </button>
  </div>
</div>

<!-- PRO -->
<div class="plan-card">
  <div class="plan-top">
    <h3>Pro</h3>
    <p>Acesso completo para uso recorrente e decisório.</p>
    <ul>
      <li>Acesso completo a todos os ativos</li>
      <li>Screener e ranking de Long Straddle</li>
      <li>Classificação objetiva (Barato, Justo ou Caro)</li>
      <li>Avaliação D+1 com Crush de Volatilidade</li>
      <li>Histórico próprio de volatilidade implícita</li>
      <li>Comportamento da IV em D-1, D0 e D+1</li>
    </ul>
  </div>

  <div class="plan-actions">
    <button class="btn-primary" onclick="assinarPlano('PRO_MENSAL')">
      Pro Mensal — R$ 185 / mês
    </button>

    <button class="btn-primary" onclick="assinarPlano('PRO_ANUAL')">
      Pro Anual — R$ 1.850 / ano
    </button>
  </div>
</div>

</div>

<!-- ÁREA DE TESTE -->
<div class="test-area">
  <h3>Plano de Teste (temporário)</h3>
  <p class="lead">
    Apenas para validação de pagamento em produção.
  </p>

  <button class="btn-primary btn-test" onclick="assinarPlano('TESTE')">
    Plano de Teste — R$ 1
  </button>
</div>

</main>

<footer>
© 2026 Algop — Sistema de análise objetiva e apoio à decisão em operações com opções.<br>
O Algop não executa operações nem fornece recomendações de investimento.
</footer>

<script>
function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(';').shift();
  return null;
}

function assinarPlano(codigo) {
  const csrfToken = getCookie("csrftoken");

  fetch("/payments/assinatura/criar/", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-CSRFToken": csrfToken
    },
    body: JSON.stringify({ codigo: codigo })
  })
  .then(resp => resp.json())
  .then(data => {
    if (!data.init_point) {
      alert("Erro ao iniciar pagamento");
      return;
    }
    window.location.href = data.init_point;
  })
  .catch(() => {
    alert("Erro ao conectar com pagamento");
  });
}
</script>

</body>
</html>
