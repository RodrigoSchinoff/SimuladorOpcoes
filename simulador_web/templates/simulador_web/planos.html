<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Planos - Algop</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:#020617;
  color:#e5e7eb;
  margin:0;
}

header{
  padding:20px 48px;
  border-bottom:1px solid rgba(148,163,184,.18);
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header h1{margin:0;font-size:22px}
header h1 span{color:#3b82f6}
header a{
  color:#e5e7eb;
  text-decoration:none;
  border:1px solid rgba(148,163,184,.25);
  padding:10px 18px;
  border-radius:10px;
}

main{
  max-width:1100px;
  margin:80px auto;
  padding:0 24px;
  text-align:center;
}

main h2{font-size:38px;margin-bottom:12px}
main p.lead{
  color:#9ca3af;
  font-size:18px;
  margin-bottom:50px;
}

.plans{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:40px;
  align-items:stretch;
}

.plan-card{
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  background:
    radial-gradient(120% 120% at 10% 10%, rgba(59,130,246,.18), transparent),
    linear-gradient(180deg, rgba(30,41,59,.7), rgba(2,6,23,.95));
  border:1px solid rgba(148,163,184,.2);
  border-radius:22px;
  padding:32px;
}

.plan-card h3{font-size:26px;margin:0 0 10px}
.plan-card p{color:#9ca3af;margin-bottom:16px}

.plan-card ul{
  list-style:none;
  padding:0;
  margin:0 0 24px;
}

.plan-card li{margin-bottom:8px}
.plan-card li::before{content:"✔ ";color:#3b82f6;font-weight:700}

.btn-primary{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:0;
  background:linear-gradient(90deg,#3b82f6,#60a5fa);
  color:#020617;
  font-weight:800;
  cursor:pointer;
}

.form-box{
  margin-top:20px;
  display:none;
}

.form-box form{
  display:flex;
  flex-direction:column;
  gap:10px;
}

input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid rgba(148,163,184,.25);
  background:#020617;
  color:#e5e7eb;
  font-size:14px;
}

input::placeholder{color:#9ca3af}

.error{
  display:none;
  color:#fecaca;
  background:rgba(220,38,38,.15);
  border:1px solid rgba(220,38,38,.4);
  padding:10px;
  border-radius:10px;
  font-size:13px;
}

.success{
  display:none;
  margin-top:16px;
  background:rgba(34,197,94,.15);
  border:1px solid rgba(34,197,94,.4);
  color:#bbf7d0;
  padding:14px;
  border-radius:12px;
  font-size:14px;
}

footer{
  margin-top:120px;
  padding:40px;
  border-top:1px solid rgba(148,163,184,.18);
  text-align:center;
  color:#9ca3af;
  font-size:14px;
}
</style>
</head>

<body>

<header>
  <h1>Algop</h1>
  <a href="/">Voltar</a>
</header>

<main>
<h2>Planos de acesso ao Algop</h2>
<p class="lead">
  Escolha o nível de acesso mais adequado e entraremos em contato para finalizar a contratação.
</p>

<div class="plans">

<!-- BÁSICO (internamente continua trial) -->
<div class="plan-card">
  <div>
    <h3>Básico</h3>
    <p>Ideal para conhecer a metodologia e a forma de análise do Algop.</p>
    <ul>
      <li>Acesso limitado à plataforma</li>
      <li>Screener de Long Straddle</li>
      <li>Avaliação focada em D+1</li>
    </ul>
  </div>

  <button class="btn-primary" onclick="toggleForm('trial')">Contratar Plano Básico</button>

  <div class="form-box" id="form-trial">
    <form onsubmit="return validarCPF(this)">
      <input type="hidden" name="plano" value="trial">
      <input name="nome" placeholder="Nome" required>
      <input name="email" type="email" placeholder="E-mail" required>
      <input name="whatsapp" placeholder="WhatsApp" required>
      <input name="cpf" placeholder="CPF" required>
      <div class="error">CPF inválido.</div>
      <button class="btn-primary" type="submit">Enviar solicitação</button>
    </form>
  </div>

  <div class="success">
    Solicitação enviada com sucesso. Entraremos em contato.
  </div>
</div>

<!-- PRO -->
<div class="plan-card">
  <div>
    <h3>Pro</h3>
    <p>Para uso contínuo, com acesso completo aos critérios e análises do Algop.</p>
    <ul>
      <li>Acesso completo a todos os ativos</li>
      <li>Screener e ranking de Long Straddle</li>
      <li>Classificação objetiva do LS (Barato, Justo ou Caro)</li>
      <li>Avaliação D+1 com impacto de Crush de Volatilidade</li>
      <li>Histórico próprio de volatilidade implícita</li>
      <li>Histórico de resultados com comportamento da IV em D-1, D0 e D+1</li>
    </ul>
    <p style="color:#9ca3af;font-size:14px;">
      Indicado para quem utiliza o Algop como ferramenta recorrente de análise e tomada de decisão.
    </p>
  </div>

  <button class="btn-primary" onclick="toggleForm('pro')">Contratar Plano Pro</button>

  <div class="form-box" id="form-pro">
    <form onsubmit="return validarCPF(this)">
      <input type="hidden" name="plano" value="pro">
      <input name="nome" placeholder="Nome" required>
      <input name="email" type="email" placeholder="E-mail" required>
      <input name="whatsapp" placeholder="WhatsApp" required>
      <input name="cpf" placeholder="CPF" required>
      <div class="error">CPF inválido.</div>
      <button class="btn-primary" type="submit">Enviar solicitação</button>
    </form>
  </div>

  <div class="success">
    Solicitação enviada com sucesso. Entraremos em contato.
  </div>
</div>

</div>
</main>

<footer>
© 2026 Algop — Sistema de análise objetiva e apoio à decisão em operações com opções.<br>
O Algop não executa operações nem fornece recomendações de investimento.
</footer>

<script>
function toggleForm(plano){
  const el = document.getElementById("form-"+plano);
  el.style.display = el.style.display === "block" ? "none" : "block";
}

function getCookie(name){
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(';').shift();
  return null;
}

function validarCPF(form){
  const cpfInput = form.querySelector("input[name='cpf']");
  const error = form.querySelector(".error");
  const success = form.closest(".plan-card").querySelector(".success");
  const cpf = cpfInput.value.replace(/\D/g,'');

  error.style.display="none";

  if(cpf.length !== 11 || /^(\d)\1+$/.test(cpf)){
    error.style.display="block";
    return false;
  }

  let soma=0, resto;
  for(let i=1;i<=9;i++) soma+=parseInt(cpf[i-1])*(11-i);
  resto=(soma*10)%11;
  if(resto===10||resto===11) resto=0;
  if(resto!==parseInt(cpf[9])){ error.style.display="block"; return false; }

  soma=0;
  for(let i=1;i<=10;i++) soma+=parseInt(cpf[i-1])*(12-i);
  resto=(soma*10)%11;
  if(resto===10||resto===11) resto=0;
  if(resto!==parseInt(cpf[10])){ error.style.display="block"; return false; }

  const payload = {
    plano: (form.querySelector("input[name='plano']")?.value || "").trim(),
    nome: (form.querySelector("input[name='nome']")?.value || "").trim(),
    email: (form.querySelector("input[name='email']")?.value || "").trim(),
    whatsapp: (form.querySelector("input[name='whatsapp']")?.value || "").trim(),
    cpf: cpf
  };

  fetch("/app/planos/", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-CSRFToken": getCookie("csrftoken")
    },
    body: JSON.stringify(payload)
  })
  .then((resp) => {
    if (!resp.ok) throw new Error();
    form.style.display="none";
    success.style.display="block";
  })
  .catch(() => {
    error.textContent = "Não foi possível enviar agora. Tente novamente.";
    error.style.display="block";
  });

  return false;
}
</script>

</body>
</html>
